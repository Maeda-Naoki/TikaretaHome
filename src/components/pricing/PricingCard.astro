---
import { useTranslations } from '@utils/i18n';

interface Props {
  name: string;
  price: number;
  period: string | null;
  features: string[];
  cta: string;
  recommended?: boolean;
  savings?: string;
}

const { name, price, period, features, cta, recommended = false, savings } = Astro.props;
const t = useTranslations(Astro.currentLocale);
const locale = Astro.currentLocale ?? 'ja';

// WCAG 1.1.1: チェックマークのスクリーンリーダー用テキスト
const srYes = locale === 'ja' ? '○' : 'Yes';
---

<div
  class={`p-8 rounded-card ${recommended ? 'bg-primary-50 border-2 border-primary-700 scale-105' : 'bg-white'} shadow-card hover:shadow-hover transition-all fade-in-up`}
>
  {recommended && (
    <!-- WCAG 1.4.3: primary-700(#c2410c)+white = 4.79:1 ✓ (N1: ハードコード→i18n修正) -->
    <div class="inline-block px-3 py-1 bg-primary-700 text-white text-sm font-bold rounded-soft mb-4">
      {t.pricing.recommended}
    </div>
  )}
  <h3 class="text-2xl font-bold text-warm-gray-900 mb-4">{name}</h3>
  <div class="mb-6">
    <span class="text-5xl font-bold text-warm-gray-900">
      ¥{price.toLocaleString()}
    </span>
    {period && (
      <span class="text-lg text-warm-gray-600">{period}</span>
    )}
  </div>
  {savings && (
    <!-- WCAG 1.4.3: secondary-700(#15803d) on white = 5.1:1 ✓ -->
    <div class="mb-4 text-secondary-700 font-bold text-sm">
      {savings}
    </div>
  )}
  <ul class="space-y-3 mb-8">
    {features.map((feature) => (
      <li class="flex items-start gap-2 text-sm text-warm-gray-700">
        {/* WCAG 1.1.1: 情報SVGに代替テキスト、WCAG 1.4.11: secondary-600(#16a34a) on white = 3.06:1 ✓ */}
        <span class="sr-only">{srYes}</span>
        <svg class="w-5 h-5 text-secondary-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        {feature}
      </li>
    ))}
  </ul>
  <!-- WCAG 3.2.5: target="_blank" に sr-only で通知 -->
  <a
    href="https://tikareta.com"
    class={`block text-center font-bold py-3 px-6 rounded-button transition-all duration-300 ${recommended ? 'bg-primary-700 hover:bg-primary-800 text-white shadow-soft hover:shadow-hover' : 'bg-warm-gray-100 hover:bg-warm-gray-200 text-warm-gray-900'}`}
    target="_blank"
    rel="noopener noreferrer"
  >
    {cta}
    <span class="sr-only">{t.common.newTab}</span>
  </a>
</div>
